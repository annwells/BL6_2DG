## Scree plot and summary statistics spleen
```{r PCA spleen log}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

tdata.FPKM.sample.info.spleen <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Spleen") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.spleen)

log.tdata.FPKM.spleen <- rownames_to_column(log.tdata.FPKM) 

log.tdata.FPKM.spleen <- log.tdata.FPKM.spleen %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.spleen, center = T)

screeplot(pca,type = "lines")

summary(pca)
```

## Time and treatment spleen 
```{r spleen time and treatment}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

treatment_time <-paste(tdata.FPKM.sample.info$Treatment, tdata.FPKM.sample.info$Time)

tdata.FPKM.sample.info <-cbind(tdata.FPKM.sample.info,treatment_time)

tdata.FPKM.sample.info.spleen <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Spleen") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.spleen)

log.tdata.FPKM.spleen <- rownames_to_column(log.tdata.FPKM) 

log.tdata.FPKM.spleen <- log.tdata.FPKM.spleen %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.spleen, center = T)

screeplot(pca,type = "lines")

summary(pca)

Treatment_time_color <- as.factor(tdata.FPKM.sample.info.spleen$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2])
pca_treatment_time <- as.data.frame(pca_treatment_time)

p <- ggplot(pca_treatment_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment_time$Treatment_time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) + 
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (29.34%)") + ylab("PCA 2 (16.76%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_time_color, fill = as.factor(pca_treatment_time$Treatment_time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"),name="Treatment Type and Time",
                       breaks=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs"),
                       labels=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Treatment spleen
```{r spleen log PCA Treatment}

Treatment_color <- as.factor(tdata.FPKM.sample.info.spleen$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2])
pca_treatment <- as.data.frame(pca_treatment)

p <- ggplot(pca_treatment,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment$Treatment_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) + 
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (29.34%)") + ylab("PCA 2 (16.76%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_color, fill = as.factor(pca_treatment$Treatment_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Treatment Type",
                       breaks=c("2DG", "None"),
                       labels=c("2DG", "None")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Time spleen
```{r log spleen PCA Time}
Time_color <- as.factor(tdata.FPKM.sample.info.spleen$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2])
pca_time <- as.data.frame(pca_time)

p <- ggplot(pca_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_time$Time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) + 
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (29.34%)") + ylab("PCA 2 (16.76%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Time_color, fill = as.factor(pca_time$Time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Time",
                       breaks=c("4 wks", "96 hrs"),
                       labels=c("4 wks", "96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## 3D spleen
This plot is color coded by time and treatment for spleen, first collectively and then separately. To see each one click the names on the legend to make them disappear and click again to make them reappear.

```{r 3D Time and treatment spleen}
Treatment_time_color <- as.factor(tdata.FPKM.sample.info.spleen$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment_time <- as.data.frame(pca_treatment_time)
rownames(pca_treatment_time) <- rownames(tdata.FPKM.sample.info.spleen)


p <- plot_ly(pca_treatment_time, x = pca_treatment_time$`pca$x[, 1]`, y = pca_treatment_time$`pca$x[, 2]`, z = pca_treatment_time$`pca$x[, 3]`, color = pca_treatment_time$Treatment_time_color, colors = c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"), text = rownames(pca_treatment_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 29.34%"),
                     yaxis = list(title = "PC 2 16.76%"),
                     zaxis = list(title = "PC 3 13.97%")))

Treatment_color <- as.factor(tdata.FPKM.sample.info.spleen$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment <- as.data.frame(pca_treatment)
rownames(pca_treatment) <- rownames(tdata.FPKM.sample.info.spleen)


p1 <- plot_ly(pca_treatment, x = pca_treatment$`pca$x[, 1]`, y = pca_treatment$`pca$x[, 2]`, z = pca_treatment$`pca$x[, 3]`, color = pca_treatment$Treatment_color, colors = c("#CC0000", "#330033"), text = rownames(pca_treatment)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 29.34%"),
                     yaxis = list(title = "PC 2 16.76%"),
                     zaxis = list(title = "PC 3 13.97%")))

Time_color <- as.factor(tdata.FPKM.sample.info.spleen$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_time <- as.data.frame(pca_time)
rownames(pca_time) <- rownames(tdata.FPKM.sample.info.spleen)

p2 <- plot_ly(pca_time, x = pca_time$`pca$x[, 1]`, y = pca_time$`pca$x[, 2]`, z = pca_time$`pca$x[, 3]`, color = pca_time$Time_color, colors = c("#B8860B", "#00FA9A"), text = rownames(pca_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 29.34%"),
                     yaxis = list(title = "PC 2 16.76%"),
                     zaxis = list(title = "PC 3 13.97%")))
p3 <- subplot(p,p1,p2)
p3
```

## Scree plot and summary statistics kidney
```{r PCA kidney log}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

tdata.FPKM.sample.info.kidney <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Kidney") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.kidney)

log.tdata.FPKM.kidney <- rownames_to_column(log.tdata.FPKM) 

log.tdata.FPKM.kidney <- log.tdata.FPKM.kidney %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.kidney, center = T)

screeplot(pca,type = "lines")

summary(pca)
```

## Treatment and time kidney
```{r kidney time and treatment}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

treatment_time <-paste(tdata.FPKM.sample.info$Treatment, tdata.FPKM.sample.info$Time)

tdata.FPKM.sample.info <-cbind(tdata.FPKM.sample.info,treatment_time)

tdata.FPKM.sample.info.kidney <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Kidney") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.kidney)

log.tdata.FPKM.kidney <- rownames_to_column(log.tdata.FPKM) 

log.tdata.FPKM.kidney <- log.tdata.FPKM.kidney %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.kidney, center = T)

screeplot(pca,type = "lines")

summary(pca)

Treatment_time_color <- as.factor(tdata.FPKM.sample.info.kidney$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2])
pca_treatment_time <- as.data.frame(pca_treatment_time)

p <- ggplot(pca_treatment_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment_time$Treatment_time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) + 
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (32.09%)") + ylab("PCA 2 (12.96%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_time_color, fill = as.factor(pca_treatment_time$Treatment_time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"),name="Treatment Type and Time",
                       breaks=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs"),
                       labels=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Treatment kidney
```{r kidney log PCA Treatment}

Treatment_color <- as.factor(tdata.FPKM.sample.info.kidney$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2])
pca_treatment <- as.data.frame(pca_treatment)

p <- ggplot(pca_treatment,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment$Treatment_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) + 
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (32.09%)") + ylab("PCA 2 (12.96%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_color, fill = as.factor(pca_treatment$Treatment_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Treatment Type",
                       breaks=c("2DG", "None"),
                       labels=c("2DG", "None")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Time kidney
```{r log kidney PCA Time}

Time_color <- as.factor(tdata.FPKM.sample.info.kidney$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2])
pca_time <- as.data.frame(pca_time)

p <- ggplot(pca_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_time$Time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) + 
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (38.53%)") + ylab("PCA 2 (19.94%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Time_color, fill = as.factor(pca_time$Time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Time",
                       breaks=c("4 wks", "96 hrs"),
                       labels=c("4 wks", "96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## 3D kidney
This plot is color coded by time and treatment for kidney, first collectively and then separately. To see each one click the names on the legend to make them disappear and click again to make them reappear.

```{r 3D Treatment and time kidney}
Treatment_time_color <- as.factor(tdata.FPKM.sample.info.kidney$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment_time <- as.data.frame(pca_treatment_time)
rownames(pca_treatment_time) <- rownames(tdata.FPKM.sample.info.kidney)

p <- plot_ly(pca_treatment_time, x = pca_treatment_time$`pca$x[, 1]`, y = pca_treatment_time$`pca$x[, 2]`, z = pca_treatment_time$`pca$x[, 3]`, color = pca_treatment_time$Treatment_time_color, colors = c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"), text = rownames(pca_treatment_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 32.09%"),
                     yaxis = list(title = "PC 2 12.96%"),
                     zaxis = list(title = "PC 3 9.51%")))

Treatment_color <- as.factor(tdata.FPKM.sample.info.kidney$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment <- as.data.frame(pca_treatment)
rownames(pca_treatment) <- rownames(tdata.FPKM.sample.info.kidney)

p1 <- plot_ly(pca_treatment, x = pca_treatment$`pca$x[, 1]`, y = pca_treatment$`pca$x[, 2]`, z = pca_treatment$`pca$x[, 3]`, color = pca_treatment$Treatment_color, colors = c("#CC0000", "#330033"), text = rownames(pca_treatment)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 32.09%"),
                     yaxis = list(title = "PC 2 12.96%"),
                     zaxis = list(title = "PC 3 9.51%")))

Time_color <- as.factor(tdata.FPKM.sample.info.kidney$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2], pca$x[,3])
pca_time <- as.data.frame(pca_time)
rownames(pca_time) <- rownames(tdata.FPKM.sample.info.kidney)

p2 <- plot_ly(pca_time, x = pca_time$`pca$x[, 1]`, y = pca_time$`pca$x[, 2]`, z = pca_time$`pca$x[, 3]`, color = pca_time$Time_color, colors = c("#B8860B", "#00FA9A"), text = rownames(pca_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 32.09%"),
                     yaxis = list(title = "PC 2 12.96%"),
                     zaxis = list(title = "PC 3 9.51%")))
p3 <- subplot(p,p1,p2)
p3
```

## Scree plot and summary statistics hypothalamus
```{r PCA hypothalamus log}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

tdata.FPKM.sample.info.hypothalamus <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Hypothanamus") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.hypothalamus)

log.tdata.FPKM.hypothalamus <- rownames_to_column(log.tdata.FPKM) 

log.tdata.FPKM.hypothalamus <- log.tdata.FPKM.hypothalamus %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.hypothalamus, center = T)

screeplot(pca,type = "lines")

summary(pca)
```

## Treatment and time hypothalamus
```{r hypothalamus time and treatment}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

treatment_time <-paste(tdata.FPKM.sample.info$Treatment, tdata.FPKM.sample.info$Time)

tdata.FPKM.sample.info <-cbind(tdata.FPKM.sample.info,treatment_time)

tdata.FPKM.sample.info.hypothalamus <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Hypothanamus") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.hypothalamus)

log.tdata.FPKM.hypothalamus <- rownames_to_column(log.tdata.FPKM) 

log.tdata.FPKM.hypothalamus <- log.tdata.FPKM.hypothalamus %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.hypothalamus, center = T)

screeplot(pca,type = "lines")

summary(pca)

Treatment_time_color <- as.factor(tdata.FPKM.sample.info.hypothalamus$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2])
pca_treatment_time <- as.data.frame(pca_treatment_time)

p <- ggplot(pca_treatment_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment_time$Treatment_time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) + 
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (38.53%)") + ylab("PCA 2 (19.94%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_time_color, fill = as.factor(pca_treatment_time$Treatment_time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"),name="Treatment Type and Time",
                       breaks=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs"),
                       labels=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Treatment hypothalamus
```{r hypothalamus log PCA Treatment}

Treatment_color <- as.factor(tdata.FPKM.sample.info.hypothalamus$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2])
pca_treatment <- as.data.frame(pca_treatment)

p <- ggplot(pca_treatment,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment$Treatment_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (38.53%)") + ylab("PCA 2 (19.94%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_color, fill = as.factor(pca_treatment$Treatment_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Treatment Type",
                       breaks=c("2DG", "None"),
                       labels=c("2DG", "None")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Time hypothalamus
```{r log hypothalamus PCA Time}
Time_color <- as.factor(tdata.FPKM.sample.info.hypothalamus$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2])
pca_time <- as.data.frame(pca_time)

p <- ggplot(pca_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_time$Time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (38.53%)") + ylab("PCA 2 (19.94%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Time_color, fill = as.factor(pca_time$Time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Time",
                       breaks=c("4 wks", "96 hrs"),
                       labels=c("4 wks", "96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## 3D hypothalamus
This plot is color coded by time and treatment for hypothalamus, first collectively and then separately. To see each one click the names on the legend to make them disappear and click again to make them reappear.

```{r 3D Treatment and time hypothalamus}
Treatment_time_color <- as.factor(tdata.FPKM.sample.info.hypothalamus$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment_time <- as.data.frame(pca_treatment_time)
rownames(pca_treatment_time) <- rownames(tdata.FPKM.sample.info.hypothalamus)

p <- plot_ly(pca_treatment_time, x = pca_treatment_time$`pca$x[, 1]`, y = pca_treatment_time$`pca$x[, 2]`, z = pca_treatment_time$`pca$x[, 3]`, color = pca_treatment_time$Treatment_time_color, colors = c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"), text = rownames(pca_treatment_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 27.09%"),
                     yaxis = list(title = "PC 2 16.01%"),
                     zaxis = list(title = "PC 3 6.69%")))

Treatment_color <- as.factor(tdata.FPKM.sample.info.hypothalamus$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment <- as.data.frame(pca_treatment)
rownames(pca_treatment) <- rownames(tdata.FPKM.sample.info.hypothalamus)

p1 <- plot_ly(pca_treatment, x = pca_treatment$`pca$x[, 1]`, y = pca_treatment$`pca$x[, 2]`, z = pca_treatment$`pca$x[, 3]`, color = pca_treatment$Treatment_color, colors = c("#CC0000", "#330033"), text = rownames(pca_treatment)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 27.09%"),
                     yaxis = list(title = "PC 2 16.01%"),
                     zaxis = list(title = "PC 3 6.69%")))

Time_color <- as.factor(tdata.FPKM.sample.info.hypothalamus$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_time <- as.data.frame(pca_time)
rownames(pca_time) <- rownames(tdata.FPKM.sample.info.hypothalamus)

p2 <- plot_ly(pca_time, x = pca_time$`pca$x[, 1]`, y = pca_time$`pca$x[, 2]`, z = pca_time$`pca$x[, 3]`, color = pca_time$Time_color, colors = c("#B8860B", "#00FA9A"), text = rownames(pca_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 27.09%"),
                     yaxis = list(title = "PC 2 16.01%"),
                     zaxis = list(title = "PC 3 6.69%")))
p3 <- subplot(p,p1,p2)
p3
```

## Scree plot and summary statistics hippocampus
```{r PCA hippocampus log}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

tdata.FPKM.sample.info.hippocampus <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Hippocampus") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.hippocampus)

log.tdata.FPKM.hippocampus <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.hippocampus <- log.tdata.FPKM.hippocampus %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.hippocampus, center = T)

screeplot(pca,type = "lines")

summary(pca)
```

## Treatment and time hippocampus
```{r hippocampus time and treatment}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

treatment_time <-paste(tdata.FPKM.sample.info$Treatment, tdata.FPKM.sample.info$Time)

tdata.FPKM.sample.info <-cbind(tdata.FPKM.sample.info,treatment_time)

tdata.FPKM.sample.info.hippocampus <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Hippocampus") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.hippocampus)

log.tdata.FPKM.hippocampus <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.hippocampus <- log.tdata.FPKM.hippocampus %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.hippocampus, center = T)

screeplot(pca,type = "lines")

summary(pca)

Treatment_time_color <- as.factor(tdata.FPKM.sample.info.hippocampus$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2])
pca_treatment_time <- as.data.frame(pca_treatment_time)

p <- ggplot(pca_treatment_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment_time$Treatment_time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (29.38%)") + ylab("PCA 2 (15.89%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_time_color, fill = as.factor(pca_treatment_time$Treatment_time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"),name="Treatment Type and Time",
                       breaks=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs"),
                       labels=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Treatment hippocampus
```{r hippocampus log PCA Treatment}
Treatment_color <- as.factor(tdata.FPKM.sample.info.hippocampus$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2])
pca_treatment <- as.data.frame(pca_treatment)

p <- ggplot(pca_treatment,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment$Treatment_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (29.38%)") + ylab("PCA 2 (15.89%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_color, fill = as.factor(pca_treatment$Treatment_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Treatment Type",
                       breaks=c("2DG", "None"),
                       labels=c("2DG", "None")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Time hippocampus
```{r log hippocampus PCA Time}
Time_color <- as.factor(tdata.FPKM.sample.info.hippocampus$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2])
pca_time <- as.data.frame(pca_time)

p <- ggplot(pca_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_time$Time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (38.53%)") + ylab("PCA 2 (19.94%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Time_color, fill = as.factor(pca_time$Time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Time",
                       breaks=c("4 wks", "96 hrs"),
                       labels=c("4 wks", "96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## 3D hippocampus
This plot is color coded by time and treatment for hippocampus, first collectively and then separately. To see each one click the names on the legend to make them disappear and click again to make them reappear.

```{r 3D Treatment and time hippocampus}
Treatment_time_color <- as.factor(tdata.FPKM.sample.info.hippocampus$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2], pca$x[,3])
pca_treatment_time <- as.data.frame(pca_treatment_time)
rownames(pca_treatment_time) <- rownames(tdata.FPKM.sample.info.hippocampus)

p <- plot_ly(pca_treatment_time, x = pca_treatment_time$`pca$x[, 1]`, y = pca_treatment_time$`pca$x[, 2]`, z = pca_treatment_time$`pca$x[, 3]`, color = pca_treatment_time$Treatment_time_color, colors = c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"), text = rownames(pca_treatment_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 29.38%"),
                     yaxis = list(title = "PC 2 15.89%"),
                     zaxis = list(title = "PC 3 12.02%")))

Treatment_color <- as.factor(tdata.FPKM.sample.info.hippocampus$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment <- as.data.frame(pca_treatment)
rownames(pca_treatment) <- rownames(tdata.FPKM.sample.info.hippocampus)

p1 <- plot_ly(pca_treatment, x = pca_treatment$`pca$x[, 1]`, y = pca_treatment$`pca$x[, 2]`, z = pca_treatment$`pca$x[, 3]`, color = pca_treatment$Treatment_color, colors = c("#CC0000", "#330033"), text = rownames(pca_treatment)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 29.38%"),
                     yaxis = list(title = "PC 2 15.89%"),
                     zaxis = list(title = "PC 3 12.02%")))

Time_color <- as.factor(tdata.FPKM.sample.info.hippocampus$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_time <- as.data.frame(pca_time)
rownames(pca_time) <- rownames(tdata.FPKM.sample.info.hippocampus)

p2 <- plot_ly(pca_time, x = pca_time$`pca$x[, 1]`, y = pca_time$`pca$x[, 2]`, z = pca_time$`pca$x[, 3]`, color = pca_time$Time_color, colors = c("#B8860B", "#00FA9A"), text = rownames(pca_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 29.38%"),
                     yaxis = list(title = "PC 2 15.89%"),
                     zaxis = list(title = "PC 3 12.02%")))
p3 <- subplot(p,p1,p2)
p3
```

## Scree plot and summary statistics liver
```{r PCA liver log}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

tdata.FPKM.sample.info.liver <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Liver") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.liver)

log.tdata.FPKM.liver <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.liver <- log.tdata.FPKM.liver %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.liver, center = T)

screeplot(pca,type = "lines")

summary(pca)
```

## Treatment and time liver
```{r liver time and treatment}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

treatment_time <-paste(tdata.FPKM.sample.info$Treatment, tdata.FPKM.sample.info$Time)

tdata.FPKM.sample.info <-cbind(tdata.FPKM.sample.info,treatment_time)

tdata.FPKM.sample.info.liver <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Liver") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.liver)

log.tdata.FPKM.liver <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.liver <- log.tdata.FPKM.liver %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.liver, center = T)

screeplot(pca,type = "lines")

summary(pca)

Treatment_time_color <- as.factor(tdata.FPKM.sample.info.liver$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2])
pca_treatment_time <- as.data.frame(pca_treatment_time)

p <- ggplot(pca_treatment_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment_time$Treatment_time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (29.79%)") + ylab("PCA 2 (11.75%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_time_color, fill = as.factor(pca_treatment_time$Treatment_time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"),name="Treatment Type and Time",
                       breaks=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs"),
                       labels=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Treatment liver
```{r liver log PCA Treatment}
Treatment_color <- as.factor(tdata.FPKM.sample.info.liver$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2])
pca_treatment <- as.data.frame(pca_treatment)

p <- ggplot(pca_treatment,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment$Treatment_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (38.53%)") + ylab("PCA 2 (19.94%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_color, fill = as.factor(pca_treatment$Treatment_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Treatment Type",
                       breaks=c("2DG", "None"),
                       labels=c("2DG", "None")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Time liver
```{r log liver PCA Time}
Time_color <- as.factor(tdata.FPKM.sample.info.liver$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2])
pca_time <- as.data.frame(pca_time)

p <- ggplot(pca_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_time$Time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (38.53%)") + ylab("PCA 2 (19.94%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Time_color, fill = as.factor(pca_time$Time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Time",
                       breaks=c("4 wks", "96 hrs"),
                       labels=c("4 wks", "96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## 3D liver
This plot is color coded by time and treatment for liver, first collectively and then separately. To see each one click the names on the legend to make them disappear and click again to make them reappear.

```{r 3D Treatment and time liver}
Treatment_time_color <- as.factor(tdata.FPKM.sample.info.liver$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment_time <- as.data.frame(pca_treatment_time)
rownames(pca_treatment_time) <- rownames(tdata.FPKM.sample.info.liver)

p <- plot_ly(pca_treatment_time, x = pca_treatment_time$`pca$x[, 1]`, y = pca_treatment_time$`pca$x[, 2]`, z = pca_treatment_time$`pca$x[, 3]`, color = pca_treatment_time$Treatment_time_color, colors = c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"), text = rownames(pca_treatment_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 29.79%"),
                     yaxis = list(title = "PC 2 11.75%"),
                     zaxis = list(title = "PC 3 8.01%")))

Treatment_color <- as.factor(tdata.FPKM.sample.info.liver$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment <- as.data.frame(pca_treatment)
rownames(pca_treatment) <- rownames(tdata.FPKM.sample.info.liver)

p1 <- plot_ly(pca_treatment, x = pca_treatment$`pca$x[, 1]`, y = pca_treatment$`pca$x[, 2]`, z = pca_treatment$`pca$x[, 3]`, color = pca_treatment$Treatment_color, colors = c("#CC0000", "#330033"), text = rownames(pca_treatment)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 29.79%"),
                     yaxis = list(title = "PC 2 11.75%"),
                     zaxis = list(title = "PC 3 8.01%")))

Time_color <- as.factor(tdata.FPKM.sample.info.liver$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_time <- as.data.frame(pca_time)
rownames(pca_time) <- rownames(tdata.FPKM.sample.info.liver)

p2 <- plot_ly(pca_time, x = pca_time$`pca$x[, 1]`, y = pca_time$`pca$x[, 2]`, z = pca_time$`pca$x[, 3]`, color = pca_time$Time_color, colors = c("#B8860B", "#00FA9A"), text = rownames(pca_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 29.79%"),
                     yaxis = list(title = "PC 2 11.75%"),
                     zaxis = list(title = "PC 3 8.01%")))
p3 <- subplot(p,p1,p2)
p3
```

## Scree plot and summary statistics heart
```{r PCA heart log}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

tdata.FPKM.sample.info.heart <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Heart") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.heart)

log.tdata.FPKM.heart <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.heart <- log.tdata.FPKM.heart %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.heart, center = T)

screeplot(pca,type = "lines")

summary(pca)
```

## Treatment and time heart
```{r heart time and treatment}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

treatment_time <-paste(tdata.FPKM.sample.info$Treatment, tdata.FPKM.sample.info$Time)

tdata.FPKM.sample.info <-cbind(tdata.FPKM.sample.info,treatment_time)

tdata.FPKM.sample.info.heart <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Heart") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.heart)

log.tdata.FPKM.heart <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.heart <- log.tdata.FPKM.heart %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.heart, center = T)

screeplot(pca,type = "lines")

summary(pca)

Treatment_time_color <- as.factor(tdata.FPKM.sample.info.heart$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2])
pca_treatment_time <- as.data.frame(pca_treatment_time)

p <- ggplot(pca_treatment_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment_time$Treatment_time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (42.9%)") + ylab("PCA 2 (12.54%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_time_color, fill = as.factor(pca_treatment_time$Treatment_time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"),name="Treatment Type and Time",
                       breaks=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs"),
                       labels=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Treatment heart
```{r heart log PCA Treatment}

Treatment_color <- as.factor(tdata.FPKM.sample.info.heart$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2])
pca_treatment <- as.data.frame(pca_treatment)

p <- ggplot(pca_treatment,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment$Treatment_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (42.9%)") + ylab("PCA 2 (12.54%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_color, fill = as.factor(pca_treatment$Treatment_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Treatment Type",
                       breaks=c("2DG", "None"),
                       labels=c("2DG", "heart")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Time heart
```{r log heart PCA Time}

Time_color <- as.factor(tdata.FPKM.sample.info.heart$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2])
pca_time <- as.data.frame(pca_time)

p <- ggplot(pca_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_time$Time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (42.9%)") + ylab("PCA 2 (12.54%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Time_color, fill = as.factor(pca_time$Time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Time",
                       breaks=c("4 wks", "96 hrs"),
                       labels=c("4 wks", "96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## 3D heart
This plot is color coded by time and treatment for heart, first collectively and then separately. To see each one click the names on the legend to make them disappear and click again to make them reappear.

```{r 3D treatment_time heart}
Treatment_time_color <- as.factor(tdata.FPKM.sample.info.heart$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment_time <- as.data.frame(pca_treatment_time)
rownames(pca_treatment_time) <- rownames(tdata.FPKM.sample.info.heart)

p <- plot_ly(pca_treatment_time, x = pca_treatment_time$`pca$x[, 1]`, y = pca_treatment_time$`pca$x[, 2]`, z = pca_treatment_time$`pca$x[, 3]`, color = pca_treatment_time$Treatment_time_color, colors = c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"), text = rownames(pca_treatment_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 42.9%"),
                     yaxis = list(title = "PC 2 12.54%"),
                     zaxis = list(title = "PC 3 10.69%")))

Treatment_color <- as.factor(tdata.FPKM.sample.info.heart$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2],pca$x[,3])
rownames(pca_treatment) <- rownames(tdata.FPKM.sample.info.heart)

p1 <- plot_ly(pca_treatment, x = pca_treatment$`pca$x[, 1]`, y = pca_treatment$`pca$x[, 2]`, z = pca_treatment$`pca$x[, 3]`, color = pca_treatment$Treatment_color, colors = c("#CC0000", "#330033"), text = rownames(pca_treatment)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 42.9%"),
                     yaxis = list(title = "PC 2 12.54%"),
                     zaxis = list(title = "PC 3 10.69%")))

Time_color <- as.factor(tdata.FPKM.sample.info.heart$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2],pca$x[,3])
rownames(pca_time) <- rownames(tdata.FPKM.sample.info.heart)

p2 <- plot_ly(pca_time, x = pca_time$`pca$x[, 1]`, y = pca_time$`pca$x[, 2]`, z = pca_time$`pca$x[, 3]`, color = pca_time$Time_color, colors = c("#B8860B", "#00FA9A"), text = rownames(pca_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 42.9%"),
                     yaxis = list(title = "PC 2 12.54%"),
                     zaxis = list(title = "PC 3 10.69%")))
p3 <- subplot(p,p1,p2)
p3
```

## Scree plot and summary statistics small intestine
```{r PCA small.intestine log}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

tdata.FPKM.sample.info.small.intestine <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Small Intestine") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.small.intestine)

log.tdata.FPKM.small.intestine <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.small.intestine <- log.tdata.FPKM.small.intestine %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.small.intestine, center = T)

screeplot(pca,type = "lines")

summary(pca)
```

## Treatment and time small instestine
```{r small.intestine time and treatment}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

treatment_time <-paste(tdata.FPKM.sample.info$Treatment, tdata.FPKM.sample.info$Time)

tdata.FPKM.sample.info <-cbind(tdata.FPKM.sample.info,treatment_time)

tdata.FPKM.sample.info.small.intestine <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Small Intestine") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.small.intestine)

log.tdata.FPKM.small.intestine <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.small.intestine <- log.tdata.FPKM.small.intestine %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.small.intestine, center = T)

screeplot(pca,type = "lines")

summary(pca)

Treatment_time_color <- as.factor(tdata.FPKM.sample.info.small.intestine$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2])
pca_treatment_time <- as.data.frame(pca_treatment_time)

p <- ggplot(pca_treatment_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment_time$Treatment_time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (19.41%)") + ylab("PCA 2 (16.59%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_time_color, fill = as.factor(pca_treatment_time$Treatment_time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"),name="Treatment Type and Time",
                       breaks=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs"),
                       labels=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Treatment small intestine
```{r small.intestine log PCA Treatment}

Treatment_color <- as.factor(tdata.FPKM.sample.info.small.intestine$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2])
pca_treatment <- as.data.frame(pca_treatment)

p <- ggplot(pca_treatment,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment$Treatment_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (19.41%)") + ylab("PCA 2 (16.59%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_color, fill = as.factor(pca_treatment$Treatment_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Treatment Type",
                       breaks=c("2DG", "None"),
                       labels=c("2DG", "small.intestine")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Time small intestine
```{r log small.intestine PCA Time}

Time_color <- as.factor(tdata.FPKM.sample.info.small.intestine$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2])
pca_time <- as.data.frame(pca_time)

p <- ggplot(pca_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_time$Time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (19.41%)") + ylab("PCA 2 (16.59%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Time_color, fill = as.factor(pca_time$Time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Time",
                       breaks=c("4 wks", "96 hrs"),
                       labels=c("4 wks", "96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## 3D small intestine
This plot is color coded by time and treatment for small intestine, first collectively and then separately. To see each one click the names on the legend to make them disappear and click again to make them reappear.

```{r 3D treatment and time small intestine}
Treatment_time_color <- as.factor(tdata.FPKM.sample.info.small.intestine$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment_time <- as.data.frame(pca_treatment_time)
rownames(pca_treatment_time) <- rownames(tdata.FPKM.sample.info.small.intestine)

p <- plot_ly(pca_treatment_time, x = pca_treatment_time$`pca$x[, 1]`, y = pca_treatment_time$`pca$x[, 2]`, z = pca_treatment_time$`pca$x[, 3]`, color = pca_treatment_time$Treatment_time_color, colors = c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"), text = rownames(pca_treatment_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 19.42%"),
                     yaxis = list(title = "PC 2 16.59%"),
                     zaxis = list(title = "PC 3 12.42%")))

Treatment_color <- as.factor(tdata.FPKM.sample.info.small.intestine$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment <- as.data.frame(pca_treatment)
rownames(pca_treatment) <- rownames(tdata.FPKM.sample.info.small.intestine)

p1 <- plot_ly(pca_treatment, x = pca_treatment$`pca$x[, 1]`, y = pca_treatment$`pca$x[, 2]`, z = pca_treatment$`pca$x[, 3]`, color = pca_treatment$Treatment_color, colors = c("#CC0000", "#330033"), text = rownames(pca_treatment)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 19.41%"),
                     yaxis = list(title = "PC 2 16.59%"),
                     zaxis = list(title = "PC 3 12.42%")))

Time_color <- as.factor(tdata.FPKM.sample.info.small.intestine$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_time <- as.data.frame(pca_time)
rownames(pca_time) <- rownames(tdata.FPKM.sample.info.small.intestine)

p2 <- plot_ly(pca_time, x = pca_time$`pca$x[, 1]`, y = pca_time$`pca$x[, 2]`, z = pca_time$`pca$x[, 3]`, color = pca_time$Time_color, colors = c("#B8860B", "#00FA9A"), text = rownames(pca_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 19.41%"),
                     yaxis = list(title = "PC 2 16.59%"),
                     zaxis = list(title = "PC 3 12.42%")))
p3 <- subplot(p,p1,p2)
p3
```

## Scree plot and summary statistics skeletal muscle
```{r PCA skeletal.muscle log}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

tdata.FPKM.sample.info.skeletal.muscle <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Skeletal Muscle") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.skeletal.muscle)

log.tdata.FPKM.skeletal.muscle <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.skeletal.muscle <- log.tdata.FPKM.skeletal.muscle %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.skeletal.muscle, center = T)

screeplot(pca,type = "lines")

summary(pca)
```

## Treatment and time skeletal muscle
```{r skeletal.muscle time and treatment}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

treatment_time <-paste(tdata.FPKM.sample.info$Treatment, tdata.FPKM.sample.info$Time)

tdata.FPKM.sample.info <-cbind(tdata.FPKM.sample.info,treatment_time)

tdata.FPKM.sample.info.skeletal.muscle <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Skeletal Muscle") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.skeletal.muscle)

log.tdata.FPKM.skeletal.muscle <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.skeletal.muscle <- log.tdata.FPKM.skeletal.muscle %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.skeletal.muscle, center = T)

screeplot(pca,type = "lines")

summary(pca)

Treatment_time_color <- as.factor(tdata.FPKM.sample.info.skeletal.muscle$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2])
pca_treatment_time <- as.data.frame(pca_treatment_time)

p <- ggplot(pca_treatment_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment_time$Treatment_time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (40.12%)") + ylab("PCA 2 (12.94%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_time_color, fill = as.factor(pca_treatment_time$Treatment_time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"),name="Treatment Type and Time",
                       breaks=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs"),
                       labels=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Treatment skeletal muscle
```{r skeletal.muscle log PCA Treatment}
Treatment_color <- as.factor(tdata.FPKM.sample.info.skeletal.muscle$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2])
pca_treatment <- as.data.frame(pca_treatment)

p <- ggplot(pca_treatment,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment$Treatment_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (40.12%)") + ylab("PCA 2 (12.94%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_color, fill = as.factor(pca_treatment$Treatment_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Treatment Type",
                       breaks=c("2DG", "None"),
                       labels=c("2DG", "skeletal.muscle")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

##Time skeletal muscle
```{r log skeletal.muscle PCA Time}

Time_color <- as.factor(tdata.FPKM.sample.info.skeletal.muscle$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2])
pca_time <- as.data.frame(pca_time)

p <- ggplot(pca_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_time$Time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (40.12%)") + ylab("PCA 2 (12.94%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Time_color, fill = as.factor(pca_time$Time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Time",
                       breaks=c("4 wks", "96 hrs"),
                       labels=c("4 wks", "96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## 3D skeletal muscle
This plot is color coded by time and treatment for skeletal muscle, first collectively and then separately. To see each one click the names on the legend to make them disappear and click again to make them reappear.

```{r 3D treatment and time skeletal muscle}
Treatment_time_color <- as.factor(tdata.FPKM.sample.info.skeletal.muscle$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment_time <- as.data.frame(pca_treatment_time)
rownames(pca_treatment_time) <- rownames(tdata.FPKM.sample.info.skeletal.muscle)

p <- plot_ly(pca_treatment_time, x = pca_treatment_time$`pca$x[, 1]`, y = pca_treatment_time$`pca$x[, 2]`, z = pca_treatment_time$`pca$x[, 3]`, color = pca_treatment_time$Treatment_time_color, colors = c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"), text = rownames(pca_treatment_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 40.12%"),
                     yaxis = list(title = "PC 2 12.94%"),
                     zaxis = list(title = "PC 3 8.81%")))

Treatment_color <- as.factor(tdata.FPKM.sample.info.skeletal.muscle$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment <- as.data.frame(pca_treatment)
rownames(pca_treatment) <- rownames(tdata.FPKM.sample.info.skeletal.muscle)

p1 <- plot_ly(pca_treatment, x = pca_treatment$`pca$x[, 1]`, y = pca_treatment$`pca$x[, 2]`, z = pca_treatment$`pca$x[, 3]`, color = pca_treatment$Treatment_color, colors = c("#CC0000", "#330033"), text = rownames(pca_treatment)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 40.12%"),
                     yaxis = list(title = "PC 2 12.94%"),
                     zaxis = list(title = "PC 3 8.81%")))

Time_color <- as.factor(tdata.FPKM.sample.info.skeletal.muscle$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_time <- as.data.frame(pca_time)
rownames(pca_time) <- rownames(tdata.FPKM.sample.info.skeletal.muscle)

p2 <- plot_ly(pca_time, x = pca_time$`pca$x[, 1]`, y = pca_time$`pca$x[, 2]`, z = pca_time$`pca$x[, 3]`, color = pca_time$Time_color, colors = c("#B8860B", "#00FA9A"), text = rownames(pca_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 40.12%"),
                     yaxis = list(title = "PC 2 12.94%"),
                     zaxis = list(title = "PC 3 8.81%")))
p3 <- subplot(p,p1,p2)
p3
```

## Scree plot and summary statistics prefrontal cortex
```{r PCA prefrontal.cortex log}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

tdata.FPKM.sample.info.prefrontal.cortex <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Pre-frontal Cortex") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.prefrontal.cortex)

log.tdata.FPKM.prefrontal.cortex <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.prefrontal.cortex <- log.tdata.FPKM.prefrontal.cortex %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.prefrontal.cortex, center = T)

screeplot(pca,type = "lines")

summary(pca)
```

## Treatment and time prefrontal cortex
```{r prefrontal.cortex time and treatment}
tdata.FPKM.sample.info <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_phenotypes.RData"))

treatment_time <-paste(tdata.FPKM.sample.info$Treatment, tdata.FPKM.sample.info$Time)

tdata.FPKM.sample.info <-cbind(tdata.FPKM.sample.info,treatment_time)

tdata.FPKM.sample.info.prefrontal.cortex <- rownames_to_column(tdata.FPKM.sample.info) %>% filter(Tissue=="Pre-frontal Cortex") %>% column_to_rownames('rowname')

tdata.FPKM <- readRDS(here("Data","20190406_RNAseq_B6_4wk_2DG_counts_numeric.RData"))

log.tdata.FPKM <- log(tdata.FPKM + 1)
log.tdata.FPKM <- as.data.frame(log.tdata.FPKM)

rows <- rownames(tdata.FPKM.sample.info.prefrontal.cortex)

log.tdata.FPKM.prefrontal.cortex <- rownames_to_column(log.tdata.FPKM)

log.tdata.FPKM.prefrontal.cortex <- log.tdata.FPKM.prefrontal.cortex %>% filter(rowname %in% rows) %>% column_to_rownames('rowname')

pca <- prcomp(log.tdata.FPKM.prefrontal.cortex, center = T)

screeplot(pca,type = "lines")

summary(pca)

Treatment_time_color <- as.factor(tdata.FPKM.sample.info.prefrontal.cortex$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2])
pca_treatment_time <- as.data.frame(pca_treatment_time)

p <- ggplot(pca_treatment_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment_time$Treatment_time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (26.4%)") + ylab("PCA 2 (17.7%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_time_color, fill = as.factor(pca_treatment_time$Treatment_time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"),name="Treatment Type and Time",
                       breaks=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs"),
                       labels=c("None 4 wks", "2DG 96 hrs", "2DG 4 wks", "None 96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Treatment prefrontal cortex
```{r prefrontal.cortex log PCA Treatment}
Treatment_color <- as.factor(tdata.FPKM.sample.info.prefrontal.cortex$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2])
pca_treatment <- as.data.frame(pca_treatment)

p <- ggplot(pca_treatment,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_treatment$Treatment_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (26.4%)") + ylab("PCA 2 (17.7%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Treatment_color, fill = as.factor(pca_treatment$Treatment_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Treatment Type",
                       breaks=c("2DG", "None"),
                       labels=c("2DG", "prefrontal.cortex")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## Time prefrontal cortex
```{r log prefrontal.cortex PCA Time}

Time_color <- as.factor(tdata.FPKM.sample.info.prefrontal.cortex$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2])
pca_time <- as.data.frame(pca_time)

p <- ggplot(pca_time,aes(pca$x[,1], pca$x[,2]))
p <- p + geom_point(aes(fill = as.factor(pca_time$Time_color)), shape=21, size=4) + theme_bw()
p <- p + theme(legend.title = element_text(size=10,face="bold")) +
  theme(legend.text = element_text(size=10, face="bold"))
p <- p + xlab("PCA 1 (26.4%)") + ylab("PCA 2 (17.7%)") + theme(axis.title = element_text(face="bold"))
p <- p + stat_ellipse(aes(pca$x[,1], pca$x[,2], group = Time_color, fill = as.factor(pca_time$Time_color)), geom="polygon",level=0.95,alpha=0.4) +
  scale_fill_manual(values=c("#A6CEE3", "#B15928"),name="Time",
                       breaks=c("4 wks", "96 hrs"),
                       labels=c("4 wks", "96 hrs")) +
  scale_linetype_manual(values=c(1,2))
print(p)
```

## 3D pre-frontal cortex
This plot is color coded by time and treatment for pre-frontal cortex, first collectively and then separately. To see each one click the names on the legend to make them disappear and click again to make them reappear.

```{r 3D treatment and time pre-frontal cortex}
Treatment_time_color <- as.factor(tdata.FPKM.sample.info.prefrontal.cortex$treatment_time)
Treatment_time_color <- as.data.frame(Treatment_time_color)
col_treatment_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(4)[Treatment_time_color$Treatment_time_color]
pca_treatment_time <- cbind(Treatment_time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment_time <- as.data.frame(pca_treatment_time)
rownames(pca_treatment_time) <- rownames(tdata.FPKM.sample.info.prefrontal.cortex)

p <- plot_ly(pca_treatment_time, x = pca_treatment_time$`pca$x[, 1]`, y = pca_treatment_time$`pca$x[, 2]`, z = pca_treatment_time$`pca$x[, 3]`, color = pca_treatment_time$Treatment_time_color, colors = c("#ED8F47", "#B89B74", "#A6CEE3", "#B15928"), text = rownames(pca_treatment_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 26.4%"),
                     yaxis = list(title = "PC 2 17.7%"),
                     zaxis = list(title = "PC 3 12.46%")))

Treatment_color <- as.factor(tdata.FPKM.sample.info.prefrontal.cortex$Treatment)
Treatment_color <- as.data.frame(Treatment_color)
col_treatment <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Treatment_color$Treatment_color]
pca_treatment <- cbind(Treatment_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_treatment <- as.data.frame(pca_treatment)
rownames(pca_treatment) <- rownames(tdata.FPKM.sample.info.prefrontal.cortex)

p1 <- plot_ly(pca_treatment, x = pca_treatment$`pca$x[, 1]`, y = pca_treatment$`pca$x[, 2]`, z = pca_treatment$`pca$x[, 3]`, color = pca_treatment$Treatment_color, colors = c("#CC0000", "#330033"), text = rownames(pca_treatment)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 26.4%"),
                     yaxis = list(title = "PC 2 17.7%"),
                     zaxis = list(title = "PC 3 12.46%")))

Time_color <- as.factor(tdata.FPKM.sample.info.prefrontal.cortex$Time)
Time_color <- as.data.frame(Time_color)
col_time <- colorRampPalette(brewer.pal(n = 12, name = "Paired"))(2)[Time_color$Time_color]
pca_time <- cbind(Time_color,pca$x[,1],pca$x[,2],pca$x[,3])
pca_time <- as.data.frame(pca_time)
rownames(pca_time) <- rownames(tdata.FPKM.sample.info.prefrontal.cortex)

p2 <- plot_ly(pca_time, x = pca_time$`pca$x[, 1]`, y = pca_time$`pca$x[, 2]`, z = pca_time$`pca$x[, 3]`, color = pca_time$Time_color, colors = c("#B8860B", "#00FA9A"), text = rownames(pca_time)) %>%
  add_markers() %>%
  layout(scene = list(xaxis = list(title = "PC 1 26.4%"),
                     yaxis = list(title = "PC 2 17.7%"),
                     zaxis = list(title = "PC 3 12.46%")))
p3 <- subplot(p,p1,p2)
p3
```
